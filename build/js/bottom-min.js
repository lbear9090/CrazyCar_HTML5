var s_aSounds,CANVAS_WIDTH=1280,CANVAS_HEIGHT=720,CH_STATUS_PAUSE=0,CH_STATUS_HORIZONTAL=1,CH_STATUS_VERTICAL=2,CH_STATUS_HOLD=3,CH_CENTER_POS_X=114.5,CH_CENTER_POS_Y=114.5,CH_ROAD_WIDTH=229,CH_ROAD_HEIGHT=229,CH_SPEED=7,s_bIsIphone=!1,TARGET_WIDTH=430,TARGET_HEIGHT=430,convertToNodeSpace=function(a,e,t){var i=t.worldPosition.x-t.anchor.x*t.width,s=t.worldPosition.y-t.anchor.y*t.height;return{x:a-=i,y:e-=s}},newButton=function(a,e,t,i,s,n,o,r,g,_,d,l,h,c,u){var m;if(d||(d=!1),l||(l=null),h||(h=2),c||(c=0),u||(u=1),d){var p=l.anchor;m=_.make.button(e-l.width*p.x,t-l.height*p.y,a,o,r,h,c,u),l.addChild(m)}else(m=_.add.button(e,t,a,o,r,h,c,u)).z_order=n,g.add(m);return m.onInputUp.add(function(){m.scale.setTo(1)},r),m.onInputDown.add(function(){m.scale.setTo(.9)},r),m.anchor.x=i,m.anchor.y=s,m},newSprite=function(a,e,t,i,s,n,o,r,g,_){var d;if(g||(g=!1),_||(_=null),g){var l=_.anchor;d=r.make.sprite(e-_.width*l.x,t-_.height*l.y,a),_.addChild(d)}else(d=r.add.sprite(e,t,a)).z_order=n,o.add(d);return d.anchor.x=i,d.anchor.y=s,d},newLabel=function(a,e,t,i,s,n,o,r,g,_,d,l,h,c,u,m,p,S){var C;l||(l=!1),h||(h=!1),c||(c=null),u||(u="rgba(0, 0, 0, 0.5"),m||(m=5),p||(p=5),S||(S=5);var f={font:"bold "+e+"px "+t,fill:i,align:"center"};if(h){var H=c.anchor;C=d.make.text(s-c.width*H.x,n-c.height*H.y,a,f),c.addChild(C)}else(C=d.add.text(s,n,a,f)).z_order=g,_.add(C);return C.anchor.x=o,C.anchor.y=r,l&&C.setShadow(m,p,u,S),C},convertSecondToMinute=function(a){var e=Math.floor(a/60),t=a%60;return(e<10?"0":"")+e+":"+(t<10?"0":"")+t},readGameData=function(a,e){return localStorage[a]?localStorage[a]:(saveGameData(a,e),e)},saveGameData=function(a,e){localStorage.setItem(a,e)},playSound=function(a,e,t){return s_aSounds[a].play(),s_aSounds[a].volume(e),s_aSounds[a].loop(t),s_aSounds[a]};function isIOS(){var a=["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"];for(-1!==navigator.userAgent.toLowerCase().indexOf("iphone")&&(s_bIsIphone=!0);a.length;)if(navigator.platform===a.pop())return!0;return s_bIsIphone=!1,!1}function sizeHandler(){window.scrollTo(0,1);var a=calculateLandscapeSize(EngagedNation.Config.Game.parent_width,EngagedNation.Config.Game.parent_height);$("#game").find("canvas").css({width:a.width,height:a.height})}function calculateLandscapeSize(a,e){var t=a,i=CANVAS_HEIGHT/CANVAS_WIDTH,s=CANVAS_WIDTH,n=CANVAS_HEIGHT;if(CANVAS_WIDTH>t&&(n=i*(s=t)),n>e&&(s=(n=e)/i),n>e){var o=n-e;s=Math.round((n-o)/n*s),n-=o}if(s>t){var r=s-t;n=Math.round((s-r)/s*n),s-=r}return{width:s,height:n}}$(window).resize(function(){sizeHandler()});var controller={game:{},createGame:function(){this.game=new Phaser.Game(CANVAS_WIDTH,CANVAS_HEIGHT,Phaser.AUTO,"game"),this.game.state.add("Preload",Preload),this.game.state.add("GamePlay",GamePlay),this.applyGlobalVariables(),this.goToPreload(),sizeHandler()},applyGlobalVariables:function(){},goToScene:function(a){this.game.state.start(a)},goToPreload:function(){this.goToScene("Preload")},goToGamePlay:function(){this.goToScene("GamePlay")}},cnt_files=0,cnt_loaded_files=0,Preload={game:controller.game,lblProgress:{},init:function(){this.game.renderer.renderSession.roundPixels=!0,this.game.scale.scaleMode=Phaser.ScaleManager.SHOW_ALL,this.game.scale.pageAlignHorizontally=!0},preload:function(){},create:function(){this.game.stage.backgroundColor="black",this.group=this.game.add.group(),this.lblProgress=newLabel("",20,EngagedNation.Config.Game.text_font,"white",CANVAS_WIDTH/2,CANVAS_HEIGHT/2,.5,.5,1,this.group,this.game),this.game.load.onLoadStart.add(this.loadStart,this),this.game.load.onFileComplete.add(this.fileComplete,this),this.game.load.onLoadComplete.add(this.loadComplete,this),this.start()},start:function(){cnt_files=0,this.loadImage("background",EngagedNation.Config.Game.img_background),this.loadImage("btn_audio",EngagedNation.Config.Game.img_btn_audio,!0,90,90,2),this.loadImage("btn_help",EngagedNation.Config.Game.img_btn_help,!0,90,90,2),this.loadImage("crosshair_ball",EngagedNation.Config.Game.img_crosshair_ball),this.loadImage("crosshair_road",EngagedNation.Config.Game.img_crosshair_road),this.loadImage("crosshair_bg",EngagedNation.Config.Game.img_crosshair_bg),this.loadImage("dashboard",EngagedNation.Config.Game.img_dashboard),this.loadImage("header",EngagedNation.Config.Game.img_header),this.loadImage("dart",EngagedNation.Config.Game.img_dart,!0,150,596,26),this.loadImage("btn_close",EngagedNation.Config.Game.img_btn_close,!0,65,65,2),this.loadImage("instruction",EngagedNation.Config.Game.img_instruction);var a=[];a.push({filename:EngagedNation.Config.Game.audio_twang,loop:!1,volume:1,ingamename:"audio_twang"}),a.push({filename:EngagedNation.Config.Game.audio_dart_thud,loop:!1,volume:1,ingamename:"audio_dart_thud"}),a.push({filename:EngagedNation.Config.Game.audio_game_over,loop:!1,volume:1,ingamename:"audio_game_over"}),a.push({filename:EngagedNation.Config.Game.audio_game_win,loop:!1,volume:1,ingamename:"audio_game_win"}),a.push({filename:EngagedNation.Config.Game.audio_soundtrack,loop:!1,volume:1,ingamename:"audio_soundtrack"}),cnt_files+=a.length,s_aSounds=[];for(var e=0;e<a.length;e++)s_aSounds[a[e].ingamename]=new Howl({src:[a[e].filename+".mp3",a[e].path+a[e].filename+".ogg"],autoplay:!1,preload:!0,loop:a[e].loop,volume:a[e].volume,onload:this.fileComplete()});cnt_loaded_files=0,this.game.load.start()},loadSound:function(a,e){cnt_files++,this.game.load.audio(a,[e])},loadImage:function(a,e,t,i,s,n){t||(t=!1),i||(i=-1),s||(s=-1),n||(n=-1),cnt_files++,t?this.game.load.spritesheet(a,e,i,s,n):this.game.load.image(a,e)},loadStart:function(){this.lblProgress.text="Loading: 0%",this.start()},fileComplete:function(){cnt_loaded_files++,this.lblProgress.text="Loading: "+Math.floor(cnt_loaded_files/cnt_files*100)+"%"},loadComplete:function(){controller.goToScene("GamePlay")}},CrossHair=function(a,e,t,i,s){this.game=i,this.z_index=s,this.swing_direction=1;var n=newSprite("crosshair_bg",a,e,.5,.5,1,t,i),o=newSprite("crosshair_road",171.5-CH_ROAD_WIDTH/2,171.5-CH_ROAD_HEIGHT/2,0,0,2,t,i,!0,n);return this.sprBallV=newSprite("crosshair_ball",CH_CENTER_POS_X,CH_CENTER_POS_Y,.5,.5,2,t,i,!0,o),this.sprBallH=newSprite("crosshair_ball",CH_CENTER_POS_X,CH_CENTER_POS_Y,.5,.5,2,t,i,!0,o),this.setStatus(CH_STATUS_PAUSE),this.setStatus(CH_STATUS_HORIZONTAL),this};CrossHair.prototype.start=function(){this.setStatus(CH_STATUS_PAUSE),this.setStatus(CH_STATUS_HORIZONTAL)},CrossHair.prototype.setStatus=function(a){switch(this.status=a,a){case CH_STATUS_PAUSE:this.sprBallH.visible=!1,this.sprBallV.visible=!1;break;case CH_STATUS_HORIZONTAL:this.swing_direction=1,this.sprBallH.x=CH_CENTER_POS_X,this.sprBallH.y=CH_CENTER_POS_Y,this.sprBallH.visible=!0,this.sprBallV.visible=!1;break;case CH_STATUS_VERTICAL:this.swing_direction=1,this.sprBallV.x=CH_CENTER_POS_X,this.sprBallV.y=CH_CENTER_POS_Y,this.sprBallV.visible=!0}},CrossHair.prototype.takeValue=function(){switch(this.status){case CH_STATUS_HORIZONTAL:this.setStatus(CH_STATUS_VERTICAL);break;case CH_STATUS_VERTICAL:this.setStatus(CH_STATUS_HOLD)}return this.status==CH_STATUS_HOLD},CrossHair.prototype.getValue=function(){var a={};return a.x=(this.sprBallH.x-CH_CENTER_POS_X)/((CH_ROAD_WIDTH-55)/2)*10,a.y=(CH_CENTER_POS_Y-this.sprBallV.y)/((CH_ROAD_HEIGHT-55)/2)*10,a},CrossHair.prototype.update=function(){switch(this.status){case CH_STATUS_HORIZONTAL:var a=this.sprBallH.x+this.swing_direction*CH_SPEED;-1==this.swing_direction&&(a>CH_CENTER_POS_X-(CH_ROAD_WIDTH-55)/2?this.sprBallH.x=a:(this.sprBallH.x=CH_CENTER_POS_X-(CH_ROAD_WIDTH-55)/2+1,this.swing_direction=1)),1==this.swing_direction&&(a<CH_CENTER_POS_X+(CH_ROAD_WIDTH-55)/2?this.sprBallH.x=a:(this.sprBallH.x=CH_CENTER_POS_X+(CH_ROAD_WIDTH-55)/2-1,this.swing_direction=-1));break;case CH_STATUS_VERTICAL:var e=this.sprBallV.y+this.swing_direction*CH_SPEED;-1==this.swing_direction&&(e>CH_CENTER_POS_Y-(CH_ROAD_HEIGHT-55)/2?this.sprBallV.y=e:(this.sprBallV.y=CH_CENTER_POS_Y-(CH_ROAD_HEIGHT-55)/2+1,this.swing_direction=1)),1==this.swing_direction&&(e<CH_CENTER_POS_Y+(CH_ROAD_HEIGHT-55)/2?this.sprBallV.y=e:(this.sprBallV.y=CH_CENTER_POS_Y+(CH_ROAD_HEIGHT-55)/2-1,this.swing_direction=-1))}};var EngagedNation,Dart=function(a,e,t,i,s,n){this.target_x=a,this.target_y=e,this.game=i,this.sprite=newSprite("dart",a,1360,.5,.868,1,t,i),this.anim=this.sprite.animations.add("selected"),setTimeout(function(){playSound("audio_dart_thud",1,!1),o.anim.play(90),o.anim.onComplete.add(function(){s.call(n)})},150);var o=this;this.game.add.tween(this.sprite).to({y:e},300,Phaser.Easing.None,!0,0)},GAMEPLAY_STATUS_CROSSHAIR=0,GAMEPLAY_STATUS_DART=1,GAMEPLAY_GAMEOVER=2,GamePlay={game:controller.game,cnt_darts:0,score:0,ringScores:[],direct_x:-1,direct_y:-1,status:GAMEPLAY_STATUS_CROSSHAIR,init:function(){this.game.renderer.renderSession.roundPixels=!0,this.game.scale.scaleMode=Phaser.ScaleManager.SHOW_ALL,this.game.scale.pageAlignHorizontally=!0},preload:function(){},create:function(){this.createUI()},createUI:function(){this.group=this.game.add.group();var a=newSprite("background",0,0,0,0,1,this.group,this.game);a.inputEnabled=!0,a.input.priorityID=0,a.events.onInputDown.add(this.onTap,this),this.game.device.touch&&this.game.input.mouse.stop();var e=newSprite("header",0,15,0,0,1,this.group,this.game);newLabel(EngagedNation.Config.Game.text_score,40,"Arial","black",196,40,.5,.5,1,this.group,this.game,!1,!0,e),newLabel(EngagedNation.Config.Game.text_darts,40,"Arial","black",800,40,.5,.5,1,this.group,this.game,!1,!0,e),this.lblScore=newLabel("000",50,EngagedNation.Config.Game.text_font,"#9a0000",433,35,.5,.5,1,this.group,this.game,!1,!0,e),this.lblDarts=newLabel("00",50,EngagedNation.Config.Game.text_font,"#9a0000",958,35,.5,.5,1,this.group,this.game,!1,!0,e),this.score=0,this.cnt_darts=EngagedNation.Config.Game.gameplay_darts+1,this.addScore(EngagedNation.Config.Game.gameplay_start_score),this.removeDarts(0),EngagedNation.Config.Game.gameplay_header_visible||(e.visible=!1),this.isSoundOn=readGameData("sound",1),0==this.isSoundOn?this.btnSound=newButton("btn_audio",1230,50,.5,.5,5,this.onClickSound,this,this.group,this.game,!1,null,1,1,0):this.btnSound=newButton("btn_audio",1230,50,.5,.5,5,this.onClickSound,this,this.group,this.game,!1,null,0,0,1),this.btnHelp=newButton("btn_help",1140,50,.5,.5,5,this.onClickHelp,this,this.group,this.game,!1,null,0,0,1),this.sprTarget=newSprite("dashboard",640,360,.5,.5,1,this.group,this.game),this.sprCrossHair=new CrossHair(1110,550,this.group,this.game,5),this.dlgInstruction=newSprite("instruction",CANVAS_WIDTH/2,CANVAS_HEIGHT/2,.5,.5,10,this.group,this.game),newButton("btn_close",698,80,.5,.5,5,this.onClickClose,this,this.group,this.game,!0,this.dlgInstruction,0,0,1),this.dlgInstruction.visible=!1,playSound("audio_soundtrack",.1,!0),Howler.mute(1-this.isSoundOn),this.showRingScoreValues(),this.sort()},onClickSound:function(){Howler.mute(0!=this.isSoundOn),this.isSoundOn=1==this.isSoundOn?0:1,saveGameData("sound",this.isSoundOn),1==this.isSoundOn?this.btnSound.setFrames(0,0,1):this.btnSound.setFrames(1,1,0)},onClickHelp:function(){this.dlgInstruction.visible=!0},onClickClose:function(){this.dlgInstruction.visible=!1},showRingScoreValues:function(){this.ringScores[0]=EngagedNation.Config.Game.gameplay_ring_j_score,this.ringScores[1]=EngagedNation.Config.Game.gameplay_ring_i_score,this.ringScores[2]=EngagedNation.Config.Game.gameplay_ring_h_score,this.ringScores[3]=EngagedNation.Config.Game.gameplay_ring_g_score,this.ringScores[4]=EngagedNation.Config.Game.gameplay_ring_f_score,this.ringScores[5]=EngagedNation.Config.Game.gameplay_ring_e_score,this.ringScores[6]=EngagedNation.Config.Game.gameplay_ring_d_score,this.ringScores[7]=EngagedNation.Config.Game.gameplay_ring_c_score,this.ringScores[8]=EngagedNation.Config.Game.gameplay_ring_b_score,this.ringScores[9]=EngagedNation.Config.Game.gameplay_ring_a_score;for(var a=1;a<10;a++)EngagedNation.Config.Game.gameplay_horizontal_score_display&&(newLabel(this.ringScores[a].toString(),20,"Arial",a%2==0?"black":"white",260-23*a,269,.5,.5,3,this.group,this.game,!1,!0,this.sprTarget),newLabel(this.ringScores[a].toString(),20,"Arial",a%2==0?"black":"white",260+23*a,269,.5,.5,3,this.group,this.game,!1,!0,this.sprTarget)),EngagedNation.Config.Game.gameplay_vertical_score_display&&(newLabel(this.ringScores[a].toString(),20,"Arial",a%2==0?"black":"white",260,269-23*a,.5,.5,3,this.group,this.game,!1,!0,this.sprTarget),newLabel(this.ringScores[a].toString(),20,"Arial",a%2==0?"black":"white",260,269+23*a,.5,.5,3,this.group,this.game,!1,!0,this.sprTarget))},sort:function(){this.group.sort("z_order",Phaser.Group.SORT_ASCENDING)},onTap:function(){if(!this.dlgInstruction.visible&&0!=this.cnt_darts&&this.status===GAMEPLAY_STATUS_CROSSHAIR&&this.sprCrossHair.takeValue()){var a=this.sprCrossHair.getValue(),e=a.x,t=a.y;if(this.direct_x=Math.round(e),this.direct_y=Math.round(t),EngagedNation.Config.Game.gameplay_always_win_mode){var i=Math.sqrt(e*e+t*t);i>=9.5&&(e=e/i*9.4,t=t/i*9.4,this.direct_x=Math.round(e),this.direct_y=Math.round(t))}this.setStatus(GAMEPLAY_STATUS_DART),new Dart(CANVAS_WIDTH/2+e*TARGET_WIDTH/20,CANVAS_HEIGHT/2-t*TARGET_HEIGHT/20,this.group,this.game,this.onDartFinished,this)}},addScore:function(a){this.score+=a;var e="00000"+this.score;this.lblScore.text=e.substr(-5)},removeDarts:function(){this.cnt_darts--;var a="000"+this.cnt_darts;return this.lblDarts.text=a.substr(-2),0==this.cnt_darts},onDartFinished:function(){var a=Math.round(Math.sqrt(this.direct_x*this.direct_x+this.direct_y*this.direct_y));a=a<10?this.ringScores[a]:0,this.addScore(a),this.sort(),this.removeDarts()?this.setStatus(GAMEPLAY_GAMEOVER):this.setStatus(GAMEPLAY_STATUS_CROSSHAIR)},setStatus:function(a){switch(this.status=a,a){case GAMEPLAY_STATUS_CROSSHAIR:this.sprCrossHair.start();break;case GAMEPLAY_STATUS_DART:break;case GAMEPLAY_GAMEOVER:this.gameOver()}},gameOver:function(){playSound("audio_game_over",1,!1),$(controller).trigger("post_message",{status:"complete",score:this.score})},update:function(){this.sprCrossHair.update()}};"use strict";(EngagedNation={Config:{}}).Config.Game={},EngagedNation.Config.DocumentWidth=$(document).width(),function(a){EngagedNation.Config.Game={audio_twang:"./resources/sounds/cartoon_twang",audio_dart_thud:"./resources/sounds/dart_thud",audio_game_over:"./resources/sounds/game_over",audio_game_win:"./resources/sounds/game_win",audio_soundtrack:"./resources/sounds/soundtrack",img_background:"./resources/images/background.png",img_btn_audio:"./resources/images/btn_audio.png",img_btn_help:"./resources/images/btn_help.png",img_crosshair_ball:"./resources/images/crosshair_ball.png",img_crosshair_road:"./resources/images/crosshair_road.png",img_crosshair_bg:"./resources/images/crosshair_bg.png",img_dart:"./resources/images/dart.png",img_dashboard:"./resources/images/dashboard.png",img_header:"./resources/images/header.png",img_instruction:"./resources/images/instruction.png",img_btn_close:"./resources/images/btn_close.png",gameplay_darts:10,gameplay_start_score:0,text_score:"SCORE",text_darts:"DARTS",gameplay_ring_a_score:1,gameplay_ring_b_score:2,gameplay_ring_c_score:3,gameplay_ring_d_score:4,gameplay_ring_e_score:5,gameplay_ring_f_score:6,gameplay_ring_g_score:7,gameplay_ring_h_score:8,gameplay_ring_i_score:9,gameplay_ring_j_score:10,gameplay_horizontal_score_display:!0,gameplay_vertical_score_display:!0,gameplay_always_win_mode:!0,gameplay_header_visible:!0,text_font:"digital",parent_width:void 0===window.screen.availWidth&&window.screen.availWidth>0?window.screen.availWidth:a(window).width(),parent_height:void 0===window.screen.availHeight&&window.screen.availHeight>0?window.screen.availHeight:a(window).height()}}(jQuery),(EngagedNation=EngagedNation||{}).Config=EngagedNation.Config||{},EngagedNation.Config.Game=EngagedNation.Config.Game||{},function(a){function e(a){this.addMessageEventListener()}e.prototype=a.extend(e.prototype,{setConfig:function(e){a.isEmptyObject(EngagedNation.Config.Game)?this.displayLog("Configuration is not set."):a.each(EngagedNation.Config.Game,function(a,t){if(e.hasOwnProperty(a))return EngagedNation.Config.Game[a]=e[a],!0})},getType:function(e){return a.type(e)},getKeyAlias:function(a,e,t){var i="";return t&&(i="_"+t),a+"_"+e+i},addMessageEventListener:function(){var e=this;e.addPostMessage({status:"loading"}),a(window).on("message",function(a){var t=EngagedNation.Config.Game;(a=a.originalEvent).data.hasOwnProperty("en_game_config")&&(t=e.setType(a.data.en_game_config),e.setConfig(t),e.displayGame(t)),a.data.hasOwnProperty("resize")&&(EngagedNation.Config.Game.parent_width=a.data.resize.parent_width,EngagedNation.Config.Game.parent_height=a.data.resize.parent_height,sizeHandler())}),e.addPostMessage({status:"configuration-ready"})},addPostMessageEventListener:function(e){var t=this;a(e).on("post_message",function(a,e){t.addPostMessage(e)})},addPostMessage:function(a){parent.postMessage({game:a},"*")},displayGame:function(e){var t=this;setTimeout(function(){a(".loading").remove(),controller.createGame(),t.addPostMessageEventListener(controller),t.addPostMessage({status:"loaded"}),isIOS()?setTimeout(function(){sizeHandler()},200):sizeHandler()},500)},setType:function(a){return"object"==typeof a?a:JSON.parse(a)},displayLog:function(a){console.log(a)}}),new e}(jQuery);